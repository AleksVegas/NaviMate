<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –æ—Ç–ª–∞–¥–∫–∏ –ø–æ–≥–æ–¥—ã</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .debug-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; border-radius: 8px; }
        button { padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; margin: 5px; }
        .result { margin-top: 15px; padding: 10px; background: #f8f9fa; border-radius: 4px; font-family: monospace; }
        .error { color: #dc3545; }
        .success { color: #28a745; }
        .info { color: #17a2b8; }
    </style>
</head>
<body>
    <h1>üîç –¢–µ—Å—Ç –æ—Ç–ª–∞–¥–∫–∏ –ø–æ–≥–æ–¥—ã</h1>
    
    <div class="debug-section">
        <h3>1. –ü—Ä–æ–≤–µ—Ä–∫–∞ API –∫–ª—é—á–∞</h3>
        <button onclick="checkApiKey()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å API –∫–ª—é—á</button>
        <div id="apiKeyResult" class="result"></div>
    </div>
    
    <div class="debug-section">
        <h3>2. –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –ø–æ–≥–æ–¥—ã</h3>
        <button onclick="testWeatherApi()">–¢–µ—Å—Ç API –ø–æ–≥–æ–¥—ã</button>
        <div id="weatherApiResult" class="result"></div>
    </div>
    
    <div class="debug-section">
        <h3>3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ DOM</h3>
        <button onclick="checkDomElements()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å DOM</button>
        <div id="domResult" class="result"></div>
    </div>
    
    <div class="debug-section">
        <h3>4. –¢–µ—Å—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ—Ä—ã–≤–æ–≤</h3>
        <button onclick="testWindGustDisplay()">–¢–µ—Å—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ—Ä—ã–≤–æ–≤</button>
        <div id="gustResult" class="result"></div>
    </div>

    <script src="js/weather.js"></script>
    <script>
        function checkApiKey() {
            const result = document.getElementById('apiKeyResult');
            try {
                const weather = new Weather();
                if (weather.apiKey) {
                    result.innerHTML = `<span class="success">‚úÖ API –∫–ª—é—á –Ω–∞–π–¥–µ–Ω: ${weather.apiKey.substring(0, 8)}...</span>`;
                } else {
                    result.innerHTML = `<span class="error">‚ùå API –∫–ª—é—á –Ω–µ –Ω–∞–π–¥–µ–Ω</span>`;
                }
            } catch (e) {
                result.innerHTML = `<span class="error">‚ùå –û—à–∏–±–∫–∞: ${e.message}</span>`;
            }
        }
        
        async function testWeatherApi() {
            const result = document.getElementById('weatherApiResult');
            result.innerHTML = '<span class="info">‚è≥ –¢–µ—Å—Ç–∏—Ä—É–µ–º API...</span>';
            
            try {
                const weather = new Weather();
                if (!weather.apiKey) {
                    result.innerHTML = '<span class="error">‚ùå API –∫–ª—é—á –Ω–µ –Ω–∞–π–¥–µ–Ω</span>';
                    return;
                }
                
                // –¢–µ—Å—Ç–æ–≤—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã (–í–µ–Ω–∞)
                const lat = 48.2082;
                const lon = 16.3738;
                
                const data = await weather.fetchWeather(lat, lon);
                result.innerHTML = `
                    <span class="success">‚úÖ API –æ—Ç–≤–µ—Ç –ø–æ–ª—É—á–µ–Ω!</span><br>
                    <strong>–ì–æ—Ä–æ–¥:</strong> ${data.name}<br>
                    <strong>–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞:</strong> ${data.main.temp}¬∞C<br>
                    <strong>–í–µ—Ç–µ—Ä:</strong> ${data.wind.speed} –º/—Å<br>
                    <strong>–ü–æ—Ä—ã–≤—ã:</strong> ${data.wind.gust ? data.wind.gust + ' –º/—Å' : '–ù–ï–¢ –î–ê–ù–ù–´–•'}<br>
                    <strong>–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:</strong> ${data.wind.deg}¬∞<br>
                    <br>
                    <strong>–ü–æ–ª–Ω—ã–π –æ—Ç–≤–µ—Ç API:</strong><br>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                `;
            } catch (e) {
                result.innerHTML = `<span class="error">‚ùå –û—à–∏–±–∫–∞ API: ${e.message}</span>`;
            }
        }
        
        function checkDomElements() {
            const result = document.getElementById('domResult');
            const elements = {
                'weatherWind': document.getElementById('weatherWind'),
                'weatherWindGust': document.getElementById('weatherWindGust'),
                'weatherWindDir': document.getElementById('weatherWindDir'),
                'weatherHumidity': document.getElementById('weatherHumidity'),
                'weatherVisibility': document.getElementById('weatherVisibility'),
                'weatherUvIndex': document.getElementById('weatherUvIndex')
            };
            
            let html = '<strong>–ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ DOM:</strong><br>';
            Object.keys(elements).forEach(id => {
                const element = elements[id];
                if (element) {
                    html += `<span class="success">‚úÖ ${id}: –Ω–∞–π–¥–µ–Ω</span><br>`;
                } else {
                    html += `<span class="error">‚ùå ${id}: –ù–ï –Ω–∞–π–¥–µ–Ω</span><br>`;
                }
            });
            
            result.innerHTML = html;
        }
        
        function testWindGustDisplay() {
            const result = document.getElementById('gustResult');
            const gustElement = document.getElementById('weatherWindGust');
            
            if (!gustElement) {
                result.innerHTML = '<span class="error">‚ùå –≠–ª–µ–º–µ–Ω—Ç weatherWindGust –Ω–µ –Ω–∞–π–¥–µ–Ω</span>';
                return;
            }
            
            // –¢–µ—Å—Ç–∏—Ä—É–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            gustElement.textContent = '–ü–æ—Ä—ã–≤—ã: 8.5 –º/—Å';
            result.innerHTML = `
                <span class="success">‚úÖ –¢–µ—Å—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ—Ä—ã–≤–æ–≤</span><br>
                <strong>–≠–ª–µ–º–µ–Ω—Ç:</strong> ${gustElement.outerHTML}<br>
                <strong>–¢–µ–∫—Å—Ç:</strong> "${gustElement.textContent}"<br>
                <strong>–í–∏–¥–∏–º–æ—Å—Ç—å:</strong> ${gustElement.style.display !== 'none' ? '–í–∏–¥–∏–º' : '–°–∫—Ä—ã—Ç'}
            `;
        }
    </script>
</body>
</html>